<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>cPouta virtual machines in Pebbles &#8212; pebbles 4.0.0.dev1 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '4.0.0.dev1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="cpouta-virtual-machines-in-pebbles">
<h1>cPouta virtual machines in Pebbles<a class="headerlink" href="#cpouta-virtual-machines-in-pebbles" title="Permalink to this headline">¶</a></h1>
<p>These instructions show you how to create a cPouta image and use it to create OpenStackDriver Templates
in a Pebbles installation. We assume that you are
familiar with the cPouta service and you login as an admin to the Pebbles UI. Horizon web interface will be used as an example.</p>
<p>OpenStackDriver can launch cPouta virtual machines from images existing in the installation&#8217;s
cPouta environment. There might be a number of basic images with preinstalled OS, these are easier to use in Pebbles.
You may also customized virtual machines within cPouta (not covered here) and then create your own images.
Custom images must be created as described below for them to be compatible with Pebbles.</p>
<div class="section" id="using-an-existing-cpouta-image">
<h2>Using an existing cPouta image<a class="headerlink" href="#using-an-existing-cpouta-image" title="Permalink to this headline">¶</a></h2>
<p>Make sure that your Pebbles installation has the OpenStackDriver configured
(<a class="reference external" href="http://cscfi.github.io/pebbles/admin_guide.html">see the Admin guide instructions</a>).</p>
<p>We will create an OpenStackDriver template from an existing ´CentOS-7´ image.
In Pebbles web UI go to ´Configure´ tab, and click on ´Create Template´ next to OpenStackDriver.</p>
<p>Settings:</p>
<ul class="simple">
<li>Name: centos-7-vm</li>
<li>Description: CentOS 7 basic virtual machine</li>
<li>Flavor: standard.tiny</li>
<li>Image: CentOS-07</li>
<li>Maximum lifetime: 10m</li>
<li>OpenStack network UUID to place instance to or &#8216;auto&#8217;: set it to the network UUID of your cPouta project (looks like: 25da4740-5f8f-495a-be1f-ad111bc72715)</li>
<li>Exposed ports (list of ports and port ranges, separated by space): set the ports you want to be open to the virtual machine, for example to open SSH: 22</li>
<li>At the bottom, check the &#8220;Allow user to request instance firewall to allow access to user&#8217;s IP address&#8221; option, if you want the users to be able to change the local IP used to connect to the virtual machine.</li>
<li>Leave the rest as defaults</li>
</ul>
<p>Click on ´Create´, your new template is added to the Blueprint Templates list. Click on <cite>Activate</cite> next
to your template&#8217;s name so that the template is available to create Blueprints.</p>
<p>Go to <cite>Blueprints</cite> tab where you can find your new template. Click on <cite>Create Blueprint</cite> next to it.</p>
<p>Settings:</p>
<ul class="simple">
<li>Select Group: System.default (or another group for which this blueprint will be available).</li>
<li>name: CentOS-7 virtual machine</li>
<li>description: Launches a virtual machine with basic CentOS-7 OS</li>
</ul>
<p>Find your new blueprint from the Blueprints list and click on <cite>Activate</cite>.</p>
<p>Finally go to the &#8216;Dashboard&#8217; tab and launch an instance. Once the instance is running, click on &#8216;Details&#8217; to give your local IP access to the virtual machine. To get access to the virtual machine click on &#8220;Query client IP&#8221;, then on &#8220;Change client IP&#8221;.</p>
<p>In the example case, the cPouta image is configured to allow only SSH access using a rsa key for user cloud-user.
Note also, that the firewall rules has been set in the blueprint template so that only the SSH port ( port 22) is open.</p>
<p>Now you can connect to this machine using the indicated ssh connection (you can also use Putty):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ssh</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="n">your</span> <span class="n">pebbles</span> <span class="n">keypair</span><span class="o">&gt;</span> <span class="n">cloud</span><span class="o">-</span><span class="n">user</span><span class="nd">@xxx</span><span class="o">.</span><span class="n">xxx</span><span class="o">.</span><span class="n">xxx</span><span class="o">.</span><span class="n">xxx</span>
</pre></div>
</div>
<p>The virtual machine can only be accessed your via SSH and using the Pebbles private key (user create and download it from <cite>Account</cite> tab, before launching the machine! You need to create this keypair only once and reuse it after that).</p>
</div>
<div class="section" id="creating-your-own-cpouta-images-for-pebbles">
<h2>Creating your own cPouta images for Pebbles<a class="headerlink" href="#creating-your-own-cpouta-images-for-pebbles" title="Permalink to this headline">¶</a></h2>
<p>You can create blueprint templates and bluprints in Pebbles from your own custom images. The instructions below
describe what basic configuration your virtual machine should have and how the cPouta image should be created.</p>
<div class="section" id="virtual-machine-settings">
<h3>Virtual machine settings<a class="headerlink" href="#virtual-machine-settings" title="Permalink to this headline">¶</a></h3>
<p>For compatibility with the standard Pebbles installation your custom virtual machine should comply with the following:</p>
<ul class="simple">
<li>The custom virtual machine was created in cPouta using the option Instance Boot Source:Boot from image</li>
<li>a cloud-user account exists in the virtual</li>
</ul>
</div>
<div class="section" id="cpouta-image-creation">
<h3>cPouta image creation<a class="headerlink" href="#cpouta-image-creation" title="Permalink to this headline">¶</a></h3>
<p>Once you have your custom virtual machine set up following the instructions above you need to create an image from it. That
image will the used by Pebbles to launch virtual machines using the OpenStackDriver.</p>
<p>In cPouta:
* Create an image from the virtual machine (make sure the image was created as mentioned above, otherwise it is possible
that Pebbles will fail to launch virtual machines)
* Note that images are created with RAW format, which takes as much disk space as the VM disk, for ex 80Gb.
* For efficiency, you may consider transforming the image to QCOW2 (you may do so by using openstack python CLI
and qemu tools, this is not covered here though)</p>
</div>
<div class="section" id="adding-your-custom-image-to-pebbles">
<h3>Adding your custom image to Pebbles<a class="headerlink" href="#adding-your-custom-image-to-pebbles" title="Permalink to this headline">¶</a></h3>
<p>Follow the instruction at the beginning of this document.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">cPouta virtual machines in Pebbles</a><ul>
<li><a class="reference internal" href="#using-an-existing-cpouta-image">Using an existing cPouta image</a></li>
<li><a class="reference internal" href="#creating-your-own-cpouta-images-for-pebbles">Creating your own cPouta images for Pebbles</a><ul>
<li><a class="reference internal" href="#virtual-machine-settings">Virtual machine settings</a></li>
<li><a class="reference internal" href="#cpouta-image-creation">cPouta image creation</a></li>
<li><a class="reference internal" href="#adding-your-custom-image-to-pebbles">Adding your custom image to Pebbles</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/pouta_image_openstackdriver.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, CSC - Center for Scientific Computing Ltd..
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/pouta_image_openstackdriver.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>